<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>リダイレクト中...</title>
  <script>
    // クエリから pixel, url を取得
    const params = new URLSearchParams(location.search);
    const pixelId = params.get("pixel");
    const redirectUrl = params.get("url");

    if (pixelId && redirectUrl) {
      window.ttq = window.ttq || [];
      (function() {
        var t = window.ttq;
        t.methods = ["page"];
        t.setAndDefer = function(t, e) {
          t[e] = function() {
            t.push([e].concat(Array.prototype.slice.call(arguments, 0)));
          };
        };
        for (var i = 0; i < t.methods.length; i++) t.setAndDefer(t, t.methods[i]);
        t.load = function(e) {
          var n = document.createElement("script");
          n.type = "text/javascript";
          n.async = !0;
          n.src = "https://analytics.tiktok.com/i18n/pixel/events.js";
          var a = document.getElementsByTagName("script")[0];
          a.parentNode.insertBefore(n, a);
          t._i = t._i || {};
          t._i[e] = [];
          t._i[e]._u = n.src;
          t._t = t._t || {};
          t._t[e] = +new Date();
        };
        t.load(pixelId);
        t.page();
      })();

      // 1秒後にリダイレクト
      setTimeout(() => {
        location.href = redirectUrl;
      }, 1000);
    }
  </script>
</head>
<body>
  <p>ページを読み込み中です...</p>
</body>
</html>
